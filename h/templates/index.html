{% extends "base.html" %}

{% block title %}Home - SchoolLearn{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='home.css') }}">
{% endblock %}

{% block content %}

    <section id="hero" class="hero">
        <div class="container">
            <h2>Welcome to SchoolLearn</h2>
            <p>Test your knowledge with our extensive collection of MCQs and one-line questions across all subjects. Practice, learn, and excel!</p>
            <a href="#subjects" class="btn">Start Practicing</a>
        </div>
    </section>

    <section id="subjects" class="subjects">
        <div class="container">
            <h2>Practice Subjects</h2>
            <div class="subject-grid">
                <div class="subject">
                    <h3>Mathematics</h3>
                    <p>Practice MCQs on Algebra, Geometry, and more.</p>
                    <div class="question-stats">
                        <span>500+ MCQs</span>
                        <span>100+ One-line Qs</span>
                    </div>
                    <a href="{{ url_for('quiz_page', subject='math') }}" class="btn">Start Quiz</a>
                    <div class="quiz-progress" id="math-progress"></div>
                </div>
                <div class="subject">
                    <h3>Science</h3>
                    <p>Physics, Chemistry, and Biology practice tests.</p>
                    <div class="question-stats">
                        <span>450+ MCQs</span>
                        <span>90+ One-line Qs</span>
                    </div>
                    <a href="{{ url_for('quiz_page', subject='science') }}" class="btn">Start Quiz</a>
                    <div class="quiz-progress" id="science-progress"></div>
                </div>
                <div class="subject">
                    <h3>English</h3>
                    <p>Grammar, Vocabulary, and Literature practice.</p>
                    <div class="question-stats">
                        <span>400+ MCQs</span>
                        <span>80+ One-line Qs</span>
                    </div>
                    <a href="{{ url_for('quiz_page', subject='english') }}" class="btn">Start Quiz</a>
                    <div class="quiz-progress" id="english-progress"></div>
                </div>
                <div class="subject">
                    <h3>Gujarati</h3>
                    <p>Practice Gujarati language and literature.</p>
                    <div class="question-stats">
                        <span>350+ MCQs</span>
                        <span>70+ One-line Qs</span>
                    </div>
                    <a href="{{ url_for('quiz_page', subject='gujarati') }}" class="btn">Start Quiz</a>
                    <div class="quiz-progress" id="gujarati-progress"></div>
                </div>
                <div class="subject">
                    <h3>Social Science</h3>
                    <p>History, Geography, and Civics practice tests.</p>
                    <div class="question-stats">
                        <span>600+ MCQs</span>
                        <span>120+ One-line Qs</span>
                    </div>
                    <a href="{{ url_for('quiz_page', subject='social-science') }}" class="btn">Start Quiz</a>
                    <div class="quiz-progress" id="social-progress"></div>
                </div>
                <div class="subject">
                    <h3>Computer</h3>
                    <p>Programming and IT fundamentals practice.</p>
                    <div class="question-stats">
                        <span>450+ MCQs</span>
                        <span>90+ One-line Qs</span>
                    </div>
                    <a href="{{ url_for('quiz_page', subject='computer') }}" class="btn">Start Quiz</a>
                    <div class="quiz-progress" id="computer-progress"></div>
                </div>
            </div>
        </div>
    </section>

    <script src="{{ url_for('static', filename='js/quiz.js') }}"></script>

    <script>
        // Check if user is logged in
        document.addEventListener('DOMContentLoaded', function() {
            const currentUser = JSON.parse(sessionStorage.getItem('currentUser'));
            
            if (currentUser) {
                // User is logged in
                // Load user progress
                loadUserProgress();
            }
            
            // Function to load user progress
            function loadUserProgress() {
                const user = JSON.parse(sessionStorage.getItem('currentUser'));
                if (!user || !user.progress || !user.progress.completedQuizzes) return;
                
                const quizzes = user.progress.completedQuizzes;
                
                // Update progress for each subject
                if (quizzes['Mathematics']) {
                    updateProgressBar('math-progress', quizzes['Mathematics'].percentage);
                }
                if (quizzes['Science']) {
                    updateProgressBar('science-progress', quizzes['Science'].percentage);
                }
                if (quizzes['English']) {
                    updateProgressBar('english-progress', quizzes['English'].percentage);
                }
                if (quizzes['Gujarati']) {
                    updateProgressBar('gujarati-progress', quizzes['Gujarati'].percentage);
                }
                if (quizzes['Social Science']) {
                    updateProgressBar('social-progress', quizzes['Social Science'].percentage);
                }
                if (quizzes['Computer']) {
                    updateProgressBar('computer-progress', quizzes['Computer'].percentage);
                }
            }
            
            // Function to update progress bar
            function updateProgressBar(elementId, percentage) {
                const progressBar = document.createElement('div');
                progressBar.className = 'progress-bar';
                progressBar.style.width = '100%';
                progressBar.style.height = '5px';
                progressBar.style.background = '#f0f0f0';
                progressBar.style.borderRadius = '5px';
                progressBar.style.marginTop = '10px';
                progressBar.style.overflow = 'hidden';
                
                const progressFill = document.createElement('div');
                progressFill.className = 'progress-fill';
                progressFill.style.width = percentage + '%';
                progressFill.style.height = '100%';
                progressFill.style.background = '#4CAF50';
                progressFill.style.borderRadius = '5px';
                progressFill.style.transition = 'width 0.5s ease';
                
                progressBar.appendChild(progressFill);
                
                const container = document.getElementById(elementId);
                if (container) {
                    container.innerHTML = '';
                    container.appendChild(progressBar);
                    
                    // Add percentage text
                    const percentageText = document.createElement('div');
                    percentageText.style.textAlign = 'center';
                    percentageText.style.marginTop = '5px';
                    percentageText.style.fontSize = '0.8rem';
                    percentageText.style.color = '#666';
                    percentageText.textContent = percentage + '% Complete';
                    container.appendChild(percentageText);
                }
            }
        });
    </script>
{% endblock %}
